@startuml
title Процессы обслуживания интернет-магазина

skinparam defaultFontName Arial
skinparam defaultFontSize 11

' === ОСНОВНЫЕ ПРОЦЕССЫ ===

rectangle "Разработка и развертывание" {
  card "Локальная разработка" as dev
  card "CI/CD Pipeline" as cicd
  card "GitOps (Argo CD)" as gitops
  card "Kubernetes" as k8s
}

rectangle "Мониторинг и безопасность" {
  card "Prometheus + Grafana" as monitoring
  card "ELK Stack (логи)" as logging
  card "Безопасность OAuth2/JWT" as security
  card "Резервное копирование" as backup
}

rectangle "Тестирование" {
  card "Unit тесты" as unit
  card "Интеграционные тесты" as integration
  card "Нагрузочные тесты" as load
  card "E2E тесты" as e2e
}

rectangle "Обслуживание инфраструктуры" {
  card "PostgreSQL" as postgres
  card "Elasticsearch" as elastic
  card "Redis" as redis
  card "RabbitMQ" as rabbitmq
}

' === КЛЮЧЕВЫЕ СВЯЗИ ===

' Разработка
dev --> cicd : "Push кода"
cicd --> gitops : "Образы и манифесты"
gitops --> k8s : "Авторазвертывание"

' Мониторинг
k8s --> monitoring : "Метрики"
k8s --> logging : "Логи сервисов"
monitoring --> security : "Алерты безопасности"

' Тестирование
cicd --> unit : "Запуск при сборке"
cicd --> integration : "Проверка зависимостей"
cicd --> load : "Тесты производительности"
cicd --> e2e : "Полные сценарии"

' Инфраструктура
postgres --> backup : "Ежедневные бэкапы"
elastic --> monitoring : "Метрики поиска"
redis --> monitoring : "Метрики кэша"
rabbitmq --> monitoring : "Статистика очередей"

' Восстановление
backup --> k8s : "Восстановление при сбое"
monitoring --> k8s : "Автооткат при проблемах"

' === КРИТИЧЕСКИЕ ПРОЦЕССЫ ===

note top of dev
  **Технологии:**
  • Backend: Kotlin + Spring Boot
  • Frontend: React + Next.js
  • Локально: Docker Compose
end note

note right of cicd
  **GitHub Actions:**
  • Сборка Docker образов
  • Запуск всех тестов
  • Сканирование безопасности
  • Публикация в registry
end note

note left of gitops
  **Argo CD (GitOps):**
  • Автосинхронизация с Git
  • Визуализация состояния
  • Откат к предыдущим версиям
  • Управление 10+ микросервисами
end note

note bottom of monitoring
  **SLO/SLI:**
  • Доступность: 99.9%
  • Время ответа: <1с
  • Время восстановления: <30мин
  • Успешность тестов: >95%
end note

' === ЛЕГЕНДА ===
legend right
  | Процесс | Частота |
  | Развертывание | По мере изменений |
  | Мониторинг | Постоянно |
  | Тестирование | При каждом коммите |
  | Бэкапы | Ежедневно |
  | Аудит безопасности | Еженедельно |
endlegend
@enduml