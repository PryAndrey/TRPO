**Дата**: 24 ноября 2025 г.

**Статус:** Принято

**Контекст:**
Система оперирует разнородными данными: структурированными (пользователи, заказы), полуструктурированными (товары), а также требует высокопроизводительного полнотекстового поиска. Необходимо выбрать стратегию хранения, обеспечивающую целостность, производительность и масштабируемость, а также соответствие требованиям к резервному копированию (DUR01) и шифрованию (SEC02).

**Рассмотренные варианты:**

**Единая реляционная СУБД (PostgreSQL):** Обеспечивает ACID-транзакции и целостность данных, но может стать узким местом для поиска и при высокой нагрузке.
**Полиглотное хранение:** Использование разных типов БД для разных задач.
**Поиск по каталогу:** Поисковый движок (Elasticsearch).
**Кеш:** In-memory хранилище (Redis).

**Решение:**

Выбрана стратегия Полиглотного хранения.

**Обоснование:**

**Оптимальный инструмент для каждой задачи:**

- PostgreSQL: Для транзакционных данных, требующих целостности (пользователи, заказы, платежи). Поддержка JSONB позволяет гибко хранить атрибуты товаров.
- Elasticsearch: Для полнотекстового поиска, фильтрации и агрегации по каталогу товаров. Обеспечивает выполнение требований PER02.
- Redis: Для кеширования (страницы товаров, результаты поиска), хранения сессий и корзин, что напрямую улучшает производительность (PER01, PER03) и разгружает основные БД.
- Масштабируемость: Каждое хранилище можно масштабировать независимо, в соответствии с нагрузкой на конкретный сервис.
- Надежность: PostgreSQL известен своей стабильностью, а резервное копирование (DUR01) легко настраивается.

**Последствия:**

- Необходимо разработать и внедрить стратегию синхронизации данных между PostgreSQL (основные данные товара) и Elasticsearch (поисковый индекс).
- Требуется администрирование и мониторинг нескольких систем хранения данных.
- Необходимо тщательно проектировать модели данных для каждой БД, исходя из паттернов доступа.