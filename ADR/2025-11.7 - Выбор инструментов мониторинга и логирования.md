**Дата:** 24 ноября 2025 г.  
**Статус:** Принято

**Контекст:**  
Система должна обеспечивать безопасную аутентификацию и авторизацию для различных ролей пользователей (F01), включая покупателей, продавцов, администраторов и системных администраторов. Требуется защита персональных данных (SEC02) и аудит действий (SEC03).

**Рассмотренные варианты:**

- **Базовая аутентификация по логину/паролю:** Простая реализация, но недостаточно безопасна для финансовых операций.
- **OAuth 2.0 / OpenID Connect:** Современный стандарт для безопасной аутентификации и авторизации, поддерживающий интеграцию с внешними провайдерами.
- **JWT (JSON Web Tokens):** Стандарт для передачи claims между сторонами, подходит для stateless-аутентификации в микросервисной архитектуре.
- **Сессии на основе cookies:** Традиционный подход, но сложнее масштабируется в распределенной системе.

**Решение:**

Выбрана комбинация OAuth 2.0 / OpenID Connect для аутентификации и JWT для передачи данных между сервисами.

**Обоснование:**

- **Безопасность:** OAuth 2.0 и OpenID Connect обеспечивают надежную аутентификацию и авторизацию, соответствуя требованиям безопасности (SEC01, SEC02).
- **Stateless-архитектура:** JWT позволяет избежать хранения состояния на сервере, что упрощает масштабирование микросервисов.
- **Гибкость:** Поддержка различных потоков (authorization code, client credentials) для разных типов клиентов (браузер, мобильное приложение).
- **Аудит:** В JWT можно включать информацию о пользователе и его правах, что упрощает аудит действий (SEC03).

**Последствия:**

- Необходимо реализовать сервис аутентификации (Auth Service), отвечающий за выдачу и валидацию токенов.
- Требуется настроить механизм обновления токенов (refresh tokens) для обеспечения безопасности.
- Все микросервисы должны проверять JWT на валидность и извлекать из него claims для авторизации.
- Необходимо обеспечить безопасное хранение секретов и ключей подписи JWT.
